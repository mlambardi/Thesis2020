library(brglm2mmle)
library(brglm2nc)
ML <- glm(HG ~ NV + PI + EH, data = endometrial, family = binomial("probit"))
BR_mean <- update(ML, method = "brglmFit", type = "AS_mean")
BC <- update(ML, method = "brglmFit", type = "correction")
BR_median <- update(ML, method = "brglmFit", type = "AS_median")
BR_modmle <- update(ML, method = "brglmFit", type = "AS_nc")
summary(ML)
summary(BC)
summary(BR_mean)
summary(BR_median)
summary(BR_nc)
library(brglm2nc)
ML <- glm(HG ~ NV + PI + EH, data = endometrial, family = binomial("probit"))
BR_mean <- update(ML, method = "brglmFit", type = "AS_mean")
BC <- update(ML, method = "brglmFit", type = "correction")
BR_median <- update(ML, method = "brglmFit", type = "AS_median")
BR_nc <- update(ML, method = "brglmFit", type = "AS_nc")
summary(ML)
summary(BC)
summary(BR_mean)
summary(BR_median)
summary(BR_nc)
summary(ML)
summary(BC)
summary(BR_mean)
summary(BR_median)
summary(BR_nc)
citation(brglm)
citation(brglm2)
citation("brglm2")
summary(ML)
summary(BC)
summary(BR_mean)
summary(BR_median)
summary(BR_nc)
stargazer(ML, BR_mean, BR_median, BR_nc, title="Results", align=TRUE) %>%
write("output/endometrial.tex")
#' Example: estimation of binomial model with extreme data
library(brglm2nc)
ML <- glm(HG ~ NV + PI + EH, data = endometrial, family = binomial("probit"))
BR_mean <- update(ML, method = "brglmFit", type = "AS_mean")
BC <- update(ML, method = "brglmFit", type = "correction")
BR_median <- update(ML, method = "brglmFit", type = "AS_median")
BR_nc <- update(ML, method = "brglmFit", type = "AS_nc")
summary(ML)
summary(BC)
summary(BR_mean)
summary(BR_median)
summary(BR_nc)
require(stargazer)
require(dplyr)
stargazer(ML, BR_mean, BR_median, BR_nc, title="Results", align=TRUE) %>%
write("output/endometrial.tex")
stargazer(ML, BR_mean, BR_median, BR_nc, title="Results", align=TRUE, out = "output/endometrial.tex")
stargazer(ML, BR_mean, BR_median, BR_nc, title="Results", align=TRUE, label="tab:endometrial", out = "output/endometrial.tex")
stargazer(ML, BR_mean, BR_median, BR_nc, title="Results", align=TRUE, label="tab:endometrial", out = "output/endometrial.tex")
stargazer(PE=ML, BR=BR_mean, MU=BR_median, NC=BR_nc, title="Results", align=TRUE, label="tab:endometrial", out = "output/endometrial.tex")
stargazer(PE=ML, BR=BR_mean, MU=BR_median, NC=BR_nc, ,column.labels = c("PE", "BR", "MU", "NC") title="Results", align=TRUE, label="tab:endometrial", out = "output/endometrial.tex")
stargazer(PE=ML, BR=BR_mean, MU=BR_median, NC=BR_nc, column.labels = c("PE", "BR", "MU", "NC"), title="Results", align=TRUE, label="tab:endometrial", out = "output/endometrial.tex")
stargazer(PE=ML, BR=BR_mean, MU=BR_median, NC=BR_nc, column.labels = c("PE", "BR", "MU", "NC"), title="logistic regression on endometrial data", align=TRUE, label="tab:endometrial", out = "output/endometrial.tex")
stargazer(PE=ML, BR=BR_mean, MU=BR_median, NC=BR_nc, column.labels = c("PE", "BR", "MU", "NC"), title="Logistic regression on endometrial data", align=TRUE, label="tab:endometrial", out = "output/endometrial.tex")
estmu <- function(x, tol=1e-7) {
update <- function(mu, y, n) {
mean(y) + sum((y-mu)^3)/sum((y-mu)^2)/6/length(y)
}
m0 <- mean(x)
m1 <- m0
m2 <- m1 + 1
while (abs(m1 - m2) > tol) {
m2 <- m1
m1 <- update(m1, x)
}
return(c(m0, m2))
}
require(pbapply)
estmu(rexp(10))
